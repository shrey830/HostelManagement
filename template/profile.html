{% extends 'base.html' %}
{% load static %}
{% block title %}Profile{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">

        <!-- Profile Image Section -->
        <div class="col-md-4 text-center">
            <div class="card shadow p-4 rounded-4">
                <div class="mb-3">
                    <!-- Profile Image (Default + Click to Change) -->
                    <label for="profile_image" style="cursor: pointer;">
                        <img id="previewImage" 
                             src="{% if profile.profile_image %}{{ profile.profile_image.url }}{% else %}{% static 'images/background/profile.png' %}{% endif %}"
                             alt="Profile Image" 
                             class="rounded-circle img-fluid shadow" 
                             style="width: 150px; height: 150px; object-fit: cover;">
                    </label>
                    <!-- Hidden File Input -->
                    <input type="file" class="form-control d-none" id="profile_image" 
                           name="profile_image" accept="image/*" onchange="previewFile(event)">
                </div>
            </div>
        </div>

        <!-- Profile Details Form -->
        <div class="col-md-7">
            <div class="card shadow p-4 rounded-4">
                <h2 class="mb-4 text-primary">Your Profile</h2>

                <!-- Check if form submitted -->
                {% if request.method == "POST" %}
                    <h4 class="text-success">Submitted Data:</h4>
                    <ul class="list-group">
                        <li class="list-group-item"><strong>Full Name:</strong> {{ request.POST.full_name }}</li>
                        <li class="list-group-item"><strong>Date of Birth:</strong> {{ request.POST.dob }}</li>
                        <li class="list-group-item"><strong>Address:</strong> {{ request.POST.address }}</li>
                        <li class="list-group-item"><strong>Course:</strong> {{ request.POST.course }}</li>
                        <li class="list-group-item"><strong>College:</strong> {{ request.POST.college }}</li>
                        <li class="list-group-item"><strong>Phone:</strong> {{ request.POST.phone }}</li>
                    </ul>
                {% else %}
                    <form method="post" enctype="multipart/form-data" action="">
                        {% csrf_token %}

                        <!-- Full Name -->
                        <div class="mb-3">
                            <label for="full_name" class="form-label">Full Name</label>
                            <input type="text" class="form-control rounded-pill" id="full_name" name="full_name" placeholder="Enter your full name" required>
                        </div>

                        <!-- Date of Birth -->
                        <div class="mb-3">
                            <label for="dob" class="form-label">Date of Birth</label>
                            <input type="date" class="form-control rounded-pill" id="dob" name="dob" required>
                        </div>

                        <!-- Address -->
                        <div class="mb-3">
                            <label for="address" class="form-label">Address</label>
                            <textarea class="form-control rounded-4" id="address" name="address" rows="3" placeholder="Enter your address" required></textarea>
                        </div>

                        <!-- Course Name -->
                        <div class="mb-3">
                            <label for="course" class="form-label">Course Name</label>
                            <input type="text" class="form-control rounded-pill" id="course" name="course" placeholder="Enter your course name" required>
                        </div>

                        <!-- College Name -->
                        <div class="mb-3">
                            <label for="college" class="form-label">College Name</label>
                            <input type="text" class="form-control rounded-pill" id="college" name="college" placeholder="Enter your college name" required>
                        </div>

                        <!-- Phone Number -->
                        <div class="mb-3">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control rounded-pill" id="phone" name="phone" placeholder="Enter your phone number" pattern="[0-9]{10}" required>
                            <div class="form-text">Enter a 10-digit phone number.</div>
                        </div>

                        <!-- Save Button -->
                        <button type="submit" class="btn btn-success rounded-pill px-4">Save Profile</button>
                    </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Script to preview selected image -->
<script>
function previewFile(event) {
    const reader = new FileReader();
    reader.onload = function(){
        document.getElementById('previewImage').src = reader.result;
    };
    reader.readAsDataURL(event.target.files[0]);
}
</script>
{% endblock %}
